1、TCP的三次握手
    Client                                                  Server
    * 第一次握手 client发送 SYN=1(连接请求)，seq=j(随机数) 到服务器，随机进入SYN_SEND状态
    * 第二次握手：服务器接收到客户端请求，由SYN=1得知是连接请求，将SYN=1， ACK=1(确认序号有效)，ack=j+1, 并生成新的随机数seq=k 返回给客户端，进入SYN_RECV状态
    * 第三次握手：客户端收到服务器响应后，判断ack是否等于j+1，确认后发送ACK=1， ack=k+1 给客户端，客户端收到后判断ack=k+1 便建立链接

    * SYN攻击
        上述为三次握手连接的正确建立流程，SYN攻击是指客户端在短时间内伪造大量的不存在的ip向server发起链接请求SYN；
        服务器端收到链接请求后回复SYN-ACK后一直等待客户端的确认(实际等不到，那都是假的等啥呢)，就会造成未连接队列占满，从而正确的客户端确认被丢失

        解决：SYN cookie

2、四次挥手
    Client              Serer
    * 第一次挥手，客户端发送FIN 并生成随机数k，发送给Server端，用来关闭客户端到服务期端的数据传输，此时客户端进入FIN_WAIT状态
    * 第二次挥手，服务端收到客户端响应，回复ACK， ack= k+1，服务端进入time_wait状态
    * 第三次挥手，服务端发送FIN到客户端并携带随机数m，服务端进入last_ack状态，用于关闭服务端到客户端的数据传输
    * 第四次挥手，客户端收到服务端的关闭链接请求，回复ack=m+1，ACK，客户端进入time_wait状态，服务端收到后，链接关闭

3、为什么建立连接时候是三次握手，断开需要四次呢？
    * 因为在建立链接时，SYN(连接请求)和ACK(确认序号有效)可以同时发送；
    * 断开连接时一方发送FIN后仅表示不再发送数据了还能接受数据，另一方可以选择立即关闭或是数据发送完再关闭，所以FIN 和 ACK通常分开发送

4、TCP和UDP的区别
    * TCP 是有连接的，即数据开始传输前需要进行三次握手连接，传输结束后也要断开连接，而UDP是无连接的
    * TCP 保证数据发送顺序和到达顺序，还有数据超时重传来保证数据的到达，UDP则无序，甚至存在数据不可到达的情况
    * TCP 是一对一的，UDP可以是一对一，也可以是一对多，多对多

5、为什么客户端的time_wait状态要经过2MSL后才会变为close？
    * 因为最后一次的ACK可能因为网络原因丢失，在主动发送ACK后如果丢失，2MSL内再次收到FIN，客户端就会继续发送ACK，直到2MSL结束不再收到ACK，便认为另一端已收到，进入close状态
    * MSL 是指 片段在网络中最大存活时间，2MSL通常是一个发送和一个回复的时间

6、如果建立连接后客户端发生故障怎么办？
    * 显然客户端发生故障后服务端不能一直等待浪费资源，服务端有一个探活计时器， 每当客户端有一个数据请求，这个计时器就会被重置
    * 当两小时内一直没有数据请求，服务端就每隔75min会发送一个探测报文到客户端，连续10个，如果一直没响应，就会关闭链接